#!/bin/bash

set -eo pipefail

root=$1

export GOOS=js
export GOARCH=wasm

# TODO currently links to all apps
wavURL="http://localhost:8080/test2.wav"
#wavURL="https://mgnsk.github.io/go-wasm-demos/public/test2.wav"

for app in $root/cmdwasm/*/
do
    app=$(basename $app)
    echo "building $app"
    go build -ldflags "-X main.wavURL=$wavURL" -o $root/public/$app/$app.wasm $root/cmdwasm/$app/main.go
done
